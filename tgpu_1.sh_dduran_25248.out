------------ Options -------------
batchSize: 1
beta1: 0.5
checkpoints_dir: /home/dduran/My_TFG/DeepRelight-master/v1
continue_train: False
data_type: 32
dataroot: ./datasets/cityscapes/
debug: False
display_freq: 100
display_winsize: 512
feat_num: 3
fineSize: 512
fp16: False
gpu_ids: [9]
input_nc: 3
instance_feat: False
isTrain: True
label_feat: False
label_nc: 0
lambda_feat: 10.0
loadSize: 1024
load_features: False
load_pretrain: 
local_rank: 0
lr: 0.0002
max_dataset_size: inf
model: pix2pixHD
nThreads: 10
n_blocks_global: 9
n_blocks_local: 3
n_clusters: 10
n_downsample_E: 4
n_downsample_global: 4
n_layers_D: 1
n_local_enhancers: 1
name: best_model
ndf: 4
nef: 16
netG: global
ngf: 64
niter: 100
niter_decay: 100
niter_fix_global: 0
no_flip: False
no_ganFeat_loss: False
no_html: False
no_instance: True
no_lsgan: False
no_vgg_loss: False
norm: instance
num_D: 1
output_nc: 3
phase: train
pool_size: 0
print_freq: 100
resize_or_crop: scale_width
save_epoch_freq: 1
save_latest_freq: 1000
serial_batches: False
tf_log: False
use_dropout: False
verbose: False
which_epoch: latest
-------------- End ----------------
CustomDatasetDataLoader
data folder: /home/dduran/My_TFG/DeepRelight-master/datasets/track3_train; find 4000 images
dataset [TraindataFromTrack3: any2one] was created
#training images = 4000
LightTrans(
  (toHDR): BP_HDR(
    (inlayer): Sequential(
      (0): ReflectionPad2d((3, 3, 3, 3))
      (1): Conv2d(3, 32, kernel_size=(7, 7), stride=(1, 1))
      (2): InstanceNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
      (3): ReLU(inplace=True)
    )
    (encoder): Sequential(
      (0): DownBlock(
        (conv1): ConvBlock(
          (conv): Conv2d(32, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv2): DeconvBlock(
          (deconv): ConvTranspose2d(64, 64, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv3): ConvBlock(
          (conv): Conv2d(64, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight1): ConvBlock(
          (conv): Conv2d(32, 64, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight2): ConvBlock(
          (conv): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
      )
      (1): DownBlock(
        (conv1): ConvBlock(
          (conv): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv2): DeconvBlock(
          (deconv): ConvTranspose2d(128, 128, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv3): ConvBlock(
          (conv): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight1): ConvBlock(
          (conv): Conv2d(64, 128, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight2): ConvBlock(
          (conv): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
      )
      (2): DownBlock(
        (conv1): ConvBlock(
          (conv): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv2): DeconvBlock(
          (deconv): ConvTranspose2d(256, 256, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv3): ConvBlock(
          (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight1): ConvBlock(
          (conv): Conv2d(128, 256, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight2): ConvBlock(
          (conv): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
      )
      (3): DownBlock(
        (conv1): ConvBlock(
          (conv): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv2): DeconvBlock(
          (deconv): ConvTranspose2d(512, 512, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv3): ConvBlock(
          (conv): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight1): ConvBlock(
          (conv): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight2): ConvBlock(
          (conv): Conv2d(512, 512, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
      )
    )
    (manipulate): Sequential(
      (0): ResnetBlock(
        (conv_block): Sequential(
          (0): ReflectionPad2d((1, 1, 1, 1))
          (1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (2): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (3): ReLU(inplace=True)
          (4): ReflectionPad2d((1, 1, 1, 1))
          (5): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (6): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
        )
      )
      (1): ResnetBlock(
        (conv_block): Sequential(
          (0): ReflectionPad2d((1, 1, 1, 1))
          (1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (2): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (3): ReLU(inplace=True)
          (4): ReflectionPad2d((1, 1, 1, 1))
          (5): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (6): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
        )
      )
      (2): ResnetBlock(
        (conv_block): Sequential(
          (0): ReflectionPad2d((1, 1, 1, 1))
          (1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (2): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (3): ReLU(inplace=True)
          (4): ReflectionPad2d((1, 1, 1, 1))
          (5): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (6): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
        )
      )
      (3): ResnetBlock(
        (conv_block): Sequential(
          (0): ReflectionPad2d((1, 1, 1, 1))
          (1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (2): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (3): ReLU(inplace=True)
          (4): ReflectionPad2d((1, 1, 1, 1))
          (5): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (6): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
        )
      )
      (4): ResnetBlock(
        (conv_block): Sequential(
          (0): ReflectionPad2d((1, 1, 1, 1))
          (1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (2): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (3): ReLU(inplace=True)
          (4): ReflectionPad2d((1, 1, 1, 1))
          (5): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (6): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
        )
      )
      (5): ResnetBlock(
        (conv_block): Sequential(
          (0): ReflectionPad2d((1, 1, 1, 1))
          (1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (2): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (3): ReLU(inplace=True)
          (4): ReflectionPad2d((1, 1, 1, 1))
          (5): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (6): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
        )
      )
      (6): ResnetBlock(
        (conv_block): Sequential(
          (0): ReflectionPad2d((1, 1, 1, 1))
          (1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (2): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (3): ReLU(inplace=True)
          (4): ReflectionPad2d((1, 1, 1, 1))
          (5): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (6): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
        )
      )
      (7): ResnetBlock(
        (conv_block): Sequential(
          (0): ReflectionPad2d((1, 1, 1, 1))
          (1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (2): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (3): ReLU(inplace=True)
          (4): ReflectionPad2d((1, 1, 1, 1))
          (5): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (6): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
        )
      )
      (8): ResnetBlock(
        (conv_block): Sequential(
          (0): ReflectionPad2d((1, 1, 1, 1))
          (1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (2): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (3): ReLU(inplace=True)
          (4): ReflectionPad2d((1, 1, 1, 1))
          (5): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (6): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
        )
      )
    )
    (decoder): Sequential(
      (0): UpBlock(
        (conv1): DeconvBlock(
          (deconv): ConvTranspose2d(512, 256, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv2): ConvBlock(
          (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv3): DeconvBlock(
          (deconv): ConvTranspose2d(256, 256, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight1): ConvBlock(
          (conv): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight2): ConvBlock(
          (conv): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
      )
      (1): UpBlock(
        (conv1): DeconvBlock(
          (deconv): ConvTranspose2d(256, 128, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv2): ConvBlock(
          (conv): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv3): DeconvBlock(
          (deconv): ConvTranspose2d(128, 128, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight1): ConvBlock(
          (conv): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight2): ConvBlock(
          (conv): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
      )
      (2): UpBlock(
        (conv1): DeconvBlock(
          (deconv): ConvTranspose2d(128, 64, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv2): ConvBlock(
          (conv): Conv2d(64, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv3): DeconvBlock(
          (deconv): ConvTranspose2d(64, 64, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight1): ConvBlock(
          (conv): Conv2d(128, 64, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight2): ConvBlock(
          (conv): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
      )
      (3): UpBlock(
        (conv1): DeconvBlock(
          (deconv): ConvTranspose2d(64, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv2): ConvBlock(
          (conv): Conv2d(32, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv3): DeconvBlock(
          (deconv): ConvTranspose2d(32, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight1): ConvBlock(
          (conv): Conv2d(64, 32, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight2): ConvBlock(
          (conv): Conv2d(32, 32, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
      )
    )
    (shortconect): Sequential(
      (0): ReflectionPad2d((1, 1, 1, 1))
      (1): Conv2d(64, 32, kernel_size=(3, 3), stride=(1, 1))
      (2): ReLU()
    )
    (out): Sequential(
      (0): ReflectionPad2d((3, 3, 3, 3))
      (1): Conv2d(32, 3, kernel_size=(7, 7), stride=(1, 1))
      (2): Tanh()
    )
  )
  (estLight): BP_Light(
    (inlayer): Sequential(
      (0): ReflectionPad2d((3, 3, 3, 3))
      (1): Conv2d(3, 32, kernel_size=(7, 7), stride=(1, 1))
      (2): InstanceNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
      (3): ReLU(inplace=True)
    )
    (encoder): Sequential(
      (0): DownBlock(
        (conv1): ConvBlock(
          (conv): Conv2d(32, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv2): DeconvBlock(
          (deconv): ConvTranspose2d(64, 64, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv3): ConvBlock(
          (conv): Conv2d(64, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight1): ConvBlock(
          (conv): Conv2d(32, 64, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight2): ConvBlock(
          (conv): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
      )
      (1): DownBlock(
        (conv1): ConvBlock(
          (conv): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv2): DeconvBlock(
          (deconv): ConvTranspose2d(128, 128, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv3): ConvBlock(
          (conv): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight1): ConvBlock(
          (conv): Conv2d(64, 128, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight2): ConvBlock(
          (conv): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
      )
      (2): DownBlock(
        (conv1): ConvBlock(
          (conv): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv2): DeconvBlock(
          (deconv): ConvTranspose2d(256, 256, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv3): ConvBlock(
          (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight1): ConvBlock(
          (conv): Conv2d(128, 256, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight2): ConvBlock(
          (conv): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
      )
      (3): DownBlock(
        (conv1): ConvBlock(
          (conv): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv2): DeconvBlock(
          (deconv): ConvTranspose2d(512, 512, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv3): ConvBlock(
          (conv): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight1): ConvBlock(
          (conv): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight2): ConvBlock(
          (conv): Conv2d(512, 512, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
      )
    )
    (manipulate): Sequential(
      (0): ResnetBlock(
        (conv_block): Sequential(
          (0): ReflectionPad2d((1, 1, 1, 1))
          (1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (2): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (3): ReLU(inplace=True)
          (4): ReflectionPad2d((1, 1, 1, 1))
          (5): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (6): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
        )
      )
      (1): ResnetBlock(
        (conv_block): Sequential(
          (0): ReflectionPad2d((1, 1, 1, 1))
          (1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (2): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (3): ReLU(inplace=True)
          (4): ReflectionPad2d((1, 1, 1, 1))
          (5): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (6): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
        )
      )
      (2): ResnetBlock(
        (conv_block): Sequential(
          (0): ReflectionPad2d((1, 1, 1, 1))
          (1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (2): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (3): ReLU(inplace=True)
          (4): ReflectionPad2d((1, 1, 1, 1))
          (5): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (6): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
        )
      )
      (3): ResnetBlock(
        (conv_block): Sequential(
          (0): ReflectionPad2d((1, 1, 1, 1))
          (1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (2): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (3): ReLU(inplace=True)
          (4): ReflectionPad2d((1, 1, 1, 1))
          (5): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (6): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
        )
      )
      (4): ResnetBlock(
        (conv_block): Sequential(
          (0): ReflectionPad2d((1, 1, 1, 1))
          (1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (2): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (3): ReLU(inplace=True)
          (4): ReflectionPad2d((1, 1, 1, 1))
          (5): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (6): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
        )
      )
      (5): ResnetBlock(
        (conv_block): Sequential(
          (0): ReflectionPad2d((1, 1, 1, 1))
          (1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (2): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (3): ReLU(inplace=True)
          (4): ReflectionPad2d((1, 1, 1, 1))
          (5): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (6): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
        )
      )
      (6): ResnetBlock(
        (conv_block): Sequential(
          (0): ReflectionPad2d((1, 1, 1, 1))
          (1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (2): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (3): ReLU(inplace=True)
          (4): ReflectionPad2d((1, 1, 1, 1))
          (5): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (6): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
        )
      )
      (7): ResnetBlock(
        (conv_block): Sequential(
          (0): ReflectionPad2d((1, 1, 1, 1))
          (1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (2): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (3): ReLU(inplace=True)
          (4): ReflectionPad2d((1, 1, 1, 1))
          (5): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (6): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
        )
      )
      (8): ResnetBlock(
        (conv_block): Sequential(
          (0): ReflectionPad2d((1, 1, 1, 1))
          (1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (2): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (3): ReLU(inplace=True)
          (4): ReflectionPad2d((1, 1, 1, 1))
          (5): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1))
          (6): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
        )
      )
    )
    (decoder): Sequential(
      (0): UpBlock(
        (conv1): DeconvBlock(
          (deconv): ConvTranspose2d(512, 256, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv2): ConvBlock(
          (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv3): DeconvBlock(
          (deconv): ConvTranspose2d(256, 256, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight1): ConvBlock(
          (conv): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight2): ConvBlock(
          (conv): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
      )
      (1): UpBlock(
        (conv1): DeconvBlock(
          (deconv): ConvTranspose2d(256, 128, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv2): ConvBlock(
          (conv): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv3): DeconvBlock(
          (deconv): ConvTranspose2d(128, 128, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight1): ConvBlock(
          (conv): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight2): ConvBlock(
          (conv): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
      )
      (2): UpBlock(
        (conv1): DeconvBlock(
          (deconv): ConvTranspose2d(128, 64, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv2): ConvBlock(
          (conv): Conv2d(64, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv3): DeconvBlock(
          (deconv): ConvTranspose2d(64, 64, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight1): ConvBlock(
          (conv): Conv2d(128, 64, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight2): ConvBlock(
          (conv): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
      )
      (3): UpBlock(
        (conv1): DeconvBlock(
          (deconv): ConvTranspose2d(64, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv2): ConvBlock(
          (conv): Conv2d(32, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (conv3): DeconvBlock(
          (deconv): ConvTranspose2d(32, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
          (bn): InstanceNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight1): ConvBlock(
          (conv): Conv2d(64, 32, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
        (local_weight2): ConvBlock(
          (conv): Conv2d(32, 32, kernel_size=(1, 1), stride=(1, 1))
          (bn): InstanceNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (act): ReLU(inplace=True)
        )
      )
      (4): ReflectionPad2d((3, 3, 3, 3))
      (5): Conv2d(32, 3, kernel_size=(7, 7), stride=(1, 1))
      (6): Tanh()
    )
  )
  (estLight_channel): Sequential(
    (0): ReflectionPad2d((1, 1, 1, 1))
    (1): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1))
    (2): ReLU()
  )
  (toHDR_channel): Sequential(
    (0): ReflectionPad2d((1, 1, 1, 1))
    (1): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1))
    (2): ReLU()
  )
  (dropout_1): Dropout(p=0.95, inplace=False)
  (dropout_2): Dropout(p=0.95, inplace=False)
  (comb): MultiDilationResnetBlock_attention(
    (branch1): ConvBlock(
      (pad): ReflectionPad2d((2, 2, 2, 2))
      (norm): InstanceNorm2d(16, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
      (acti): ReLU(inplace=True)
      (conv): Conv2d(128, 16, kernel_size=(3, 3), stride=(1, 1), dilation=(2, 2))
    )
    (branch2): ConvBlock(
      (pad): ReflectionPad2d((3, 3, 3, 3))
      (norm): InstanceNorm2d(16, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
      (acti): ReLU(inplace=True)
      (conv): Conv2d(128, 16, kernel_size=(3, 3), stride=(1, 1), dilation=(3, 3))
    )
    (branch3): ConvBlock(
      (pad): ReflectionPad2d((4, 4, 4, 4))
      (norm): InstanceNorm2d(16, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
      (acti): ReLU(inplace=True)
      (conv): Conv2d(128, 16, kernel_size=(3, 3), stride=(1, 1), dilation=(4, 4))
    )
    (branch4): ConvBlock(
      (pad): ReflectionPad2d((5, 5, 5, 5))
      (norm): InstanceNorm2d(16, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
      (acti): ReLU(inplace=True)
      (conv): Conv2d(128, 16, kernel_size=(3, 3), stride=(1, 1), dilation=(5, 5))
    )
    (branch5): ConvBlock(
      (pad): ReflectionPad2d((6, 6, 6, 6))
      (norm): InstanceNorm2d(16, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
      (acti): ReLU(inplace=True)
      (conv): Conv2d(128, 16, kernel_size=(3, 3), stride=(1, 1), dilation=(6, 6))
    )
    (branch6): ConvBlock(
      (pad): ReflectionPad2d((8, 8, 8, 8))
      (norm): InstanceNorm2d(16, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
      (acti): ReLU(inplace=True)
      (conv): Conv2d(128, 16, kernel_size=(3, 3), stride=(1, 1), dilation=(8, 8))
    )
    (branch7): ConvBlock(
      (pad): ReflectionPad2d((10, 10, 10, 10))
      (norm): InstanceNorm2d(16, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
      (acti): ReLU(inplace=True)
      (conv): Conv2d(128, 16, kernel_size=(3, 3), stride=(1, 1), dilation=(10, 10))
    )
    (branch8): ConvBlock(
      (pad): ReflectionPad2d((12, 12, 12, 12))
      (norm): InstanceNorm2d(16, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
      (acti): ReLU(inplace=True)
      (conv): Conv2d(128, 16, kernel_size=(3, 3), stride=(1, 1), dilation=(12, 12))
    )
    (fusion): FusionLayer(
      (mergeFeather): ConvBlock(
        (conv): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (bn): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
        (act): ReLU(inplace=True)
      )
      (avg_pool): AdaptiveAvgPool2d(output_size=1)
      (fc): Sequential(
        (0): Linear(in_features=128, out_features=16, bias=False)
        (1): ReLU(inplace=True)
        (2): Linear(in_features=16, out_features=128, bias=False)
        (3): Sigmoid()
      )
      (outlayer): ConvBlock(
        (conv): Conv2d(128, 64, kernel_size=(1, 1), stride=(1, 1))
        (bn): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
        (act): ReLU(inplace=True)
      )
    )
  )
  (out): Sequential(
    (0): ReflectionPad2d((3, 3, 3, 3))
    (1): Conv2d(64, 3, kernel_size=(7, 7), stride=(1, 1))
    (2): Tanh()
  )
)
